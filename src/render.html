<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/aaaakshat/cm-web-fonts@latest/fonts.css">
  <link rel="stylesheet" href="https://manav.ch/atomic.css">
  <link rel="stylesheet" href="/cquicc.css">
  <link rel="stylesheet" href="/hljs.css">

  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

    mermaid.initialize( {
      securityLevel: 'antiscript',
      theme: "base"
    } );

    // make sure to auto rerun
    setTimeout( () => {
      mermaid.init( undefined,
        document.querySelectorAll( '.mermaid' )
      )
      const split = document.querySelector( ".split" );
      split.style.height = "calc(29.7cm - 3em - 4cm)";

      // process citations
      const processed = document
        .querySelectorAll( "a[href*='ref']" )
        .forEach( e => {
          const num = e.innerText.split( "." )[ 0 ];
          const rest = e.innerHTML.split( "." ).slice( 1 ).join( "." );

          e.outerHTML =
            `<def id="fn${ num }">
          <a href="${ e.href + num }" style="color:#000;">[${ num }]</a>
          ${ rest }
          </def>`;
        } );
      console.log( processed );

      // other splits after first
      const splits = [
        ...document.querySelectorAll( ".split" )
      ].slice( 1 );
      splits.forEach( ( split, index ) => {
        const exists = document.querySelector( `#top${ index }` );
        if ( exists ) return;

        const hr = document.createElement( "hr" );
        hr.id = `top${ index }`;
        split.insertBefore( hr, split.firstChild );
      } );
    }, 1000 );
  </script>

  &head;
</head>

<body class="flow-x-h">
  <header class="f j-bw">
    <h1 class="m0 p0" id="title">&topic;</h1>
    <div id="year">&year;</div>
  </header>
  <hr />
  <section class="f j-bw fw4">
    <div id="frontmatter-lhs">
      <div id="author">&author;</div>
      <div id="from">&from;</div>
      <div id="date">&date;</div>
    </div>
    <div class="p10" id="frontmatter-rhs">
      <img src="/iitm.svg" height="100px" width="100px" alt="">
    </div>
  </section>
  <hr />
  &body;
</body>

</html>